{"version":3,"sources":["../../../src/lib/vite-plugins/not-found.ts"],"sourcesContent":["import fs from 'node:fs';\nimport path from 'node:path';\nimport type { Plugin } from 'vite';\nimport { DIST_PUBLIC } from '../constants.js';\n\nexport function notFoundPlugin(): Plugin {\n  // This provides raw html `public/404.html` for SSR fallback.\n  // It's not used when router has 404 page.\n  const name = 'virtual:vite-rsc-waku/not-found';\n  return {\n    name: 'waku:vite-plugins:not-found',\n    resolveId(source, _importer, _options) {\n      return source === name ? '\\0' + name : undefined;\n    },\n    load(id) {\n      if (id === '\\0' + name) {\n        const notFoundHtmlPath = path.resolve(DIST_PUBLIC, '404.html');\n        if (!fs.existsSync(notFoundHtmlPath)) {\n          return `export default undefined`;\n        }\n        return `export { default } from ${JSON.stringify(notFoundHtmlPath + '?raw')}`;\n      }\n    },\n  };\n}\n"],"names":["fs","path","DIST_PUBLIC","notFoundPlugin","name","resolveId","source","_importer","_options","undefined","load","id","notFoundHtmlPath","resolve","existsSync","JSON","stringify"],"mappings":"AAAA,OAAOA,QAAQ,UAAU;AACzB,OAAOC,UAAU,YAAY;AAE7B,SAASC,WAAW,QAAQ,kBAAkB;AAE9C,OAAO,SAASC;IACd,6DAA6D;IAC7D,0CAA0C;IAC1C,MAAMC,OAAO;IACb,OAAO;QACLA,MAAM;QACNC,WAAUC,MAAM,EAAEC,SAAS,EAAEC,QAAQ;YACnC,OAAOF,WAAWF,OAAO,OAAOA,OAAOK;QACzC;QACAC,MAAKC,EAAE;YACL,IAAIA,OAAO,OAAOP,MAAM;gBACtB,MAAMQ,mBAAmBX,KAAKY,OAAO,CAACX,aAAa;gBACnD,IAAI,CAACF,GAAGc,UAAU,CAACF,mBAAmB;oBACpC,OAAO,CAAC,wBAAwB,CAAC;gBACnC;gBACA,OAAO,CAAC,wBAAwB,EAAEG,KAAKC,SAAS,CAACJ,mBAAmB,SAAS;YAC/E;QACF;IACF;AACF"}