{"version":3,"sources":["../../src/lib/types.ts"],"sourcesContent":["import type { ReactNode } from 'react';\nimport type { Config } from '../config.js';\n\ntype Elements = Record<string, unknown>;\n\nexport type Unstable_RenderRsc = (\n  elements: Elements,\n) => Promise<ReadableStream>;\n\nexport type Unstable_ParseRsc = (\n  rscStream: ReadableStream,\n) => Promise<Elements>;\n\nexport type Unstable_RenderHtml = (\n  elementsStream: ReadableStream,\n  html: ReactNode,\n  options: { rscPath: string; actionResult?: unknown; status?: number },\n) => Promise<Response>;\n\nexport type Unstable_EmitFile = (\n  filePath: string,\n  body: ReadableStream | string,\n) => Promise<void>;\n\nexport type Unstable_HandleRequest = (\n  input: (\n    | { type: 'component'; rscPath: string; rscParams: unknown }\n    | {\n        type: 'function';\n        fn: (...args: unknown[]) => Promise<unknown>;\n        args: unknown[];\n      }\n    | {\n        type: 'action';\n        fn: () => Promise<unknown>;\n      }\n    | { type: 'custom' }\n  ) & {\n    pathname: string;\n    req: Request;\n  },\n  utils: {\n    renderRsc: Unstable_RenderRsc;\n    parseRsc: Unstable_ParseRsc;\n    renderHtml: Unstable_RenderHtml;\n    loadBuildMetadata: (key: string) => Promise<string | undefined>;\n  },\n) => Promise<ReadableStream | Response | 'fallback' | null | undefined>;\n\nexport type Unstable_HandleBuild = (utils: {\n  renderRsc: Unstable_RenderRsc;\n  parseRsc: Unstable_ParseRsc;\n  renderHtml: Unstable_RenderHtml;\n  rscPath2pathname: (rscPath: string) => string;\n  saveBuildMetadata: (key: string, value: string) => Promise<void>;\n  withRequest: <T>(req: Request, fn: () => T) => T;\n  generateFile: (\n    fileName: string,\n    body: ReadableStream | string,\n  ) => Promise<void>;\n  generateDefaultHtml: (fileName: string) => Promise<void>;\n}) => Promise<void>;\n\nexport type Unstable_ServerEntry = {\n  default: {\n    fetch: (req: Request, ...args: any[]) => Response | Promise<Response>;\n    build: (\n      utils: {\n        emitFile: Unstable_EmitFile;\n      },\n      ...args: any[]\n    ) => Promise<void>;\n    buildOptions?: Record<string, unknown>;\n    buildEnhancers?: string[]; // enhancer module ids\n    [someOtherProperty: string]: unknown;\n  };\n};\n\nexport type Unstable_ProcessRequest = (\n  req: Request,\n) => Promise<Response | null>;\n\nexport type Unstable_ProcessBuild = (utils: {\n  emitFile: Unstable_EmitFile;\n}) => Promise<void>;\n\nexport type Unstable_CreateServerEntryAdapter = <Options>(\n  fn: (\n    args: {\n      processRequest: Unstable_ProcessRequest;\n      processBuild: Unstable_ProcessBuild;\n      config: Omit<Required<Config>, 'vite'>;\n      isBuild: boolean;\n      notFoundHtml: string;\n    },\n    options?: Options,\n  ) => Unstable_ServerEntry['default'],\n) => (\n  args: {\n    handleRequest: Unstable_HandleRequest;\n    handleBuild: Unstable_HandleBuild;\n  },\n  options?: Options,\n) => Unstable_ServerEntry['default'];\n"],"names":[],"mappings":"AAsFA,WAiBqC"}