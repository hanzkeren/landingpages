{"version":3,"sources":["../../../src/lib/utils/progress-logger.ts"],"sourcesContent":["// This is node.js specific code\nexport const createProgressLogger = (total?: number) => {\n  const showProgress = process.stdout.isTTY && !process.env.CI;\n  let count = 0;\n  let timer: ReturnType<typeof setTimeout> | null = null;\n  const INTERVAL = 100; // rate limit updates to every 100ms\n\n  const getPrefix = () =>\n    total !== undefined ? `(${count}/${total}) ` : `(${count}) `;\n\n  const update = (message: string) => {\n    count++;\n    if (timer) {\n      return;\n    }\n    timer = setTimeout(() => (timer = null), INTERVAL);\n    if (showProgress) {\n      process.stdout.clearLine(0);\n      process.stdout.cursorTo(0);\n      process.stdout.write(getPrefix() + message);\n    }\n  };\n\n  const done = () => {\n    if (showProgress) {\n      process.stdout.clearLine(0);\n      process.stdout.cursorTo(0);\n    }\n  };\n\n  const getCount = () => count;\n\n  return { update, done, getCount };\n};\n"],"names":["createProgressLogger","total","showProgress","process","stdout","isTTY","env","CI","count","timer","INTERVAL","getPrefix","undefined","update","message","setTimeout","clearLine","cursorTo","write","done","getCount"],"mappings":"AAAA,gCAAgC;AAChC,OAAO,MAAMA,uBAAuB,CAACC;IACnC,MAAMC,eAAeC,QAAQC,MAAM,CAACC,KAAK,IAAI,CAACF,QAAQG,GAAG,CAACC,EAAE;IAC5D,IAAIC,QAAQ;IACZ,IAAIC,QAA8C;IAClD,MAAMC,WAAW,KAAK,oCAAoC;IAE1D,MAAMC,YAAY,IAChBV,UAAUW,YAAY,CAAC,CAAC,EAAEJ,MAAM,CAAC,EAAEP,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,EAAEO,MAAM,EAAE,CAAC;IAE9D,MAAMK,SAAS,CAACC;QACdN;QACA,IAAIC,OAAO;YACT;QACF;QACAA,QAAQM,WAAW,IAAON,QAAQ,MAAOC;QACzC,IAAIR,cAAc;YAChBC,QAAQC,MAAM,CAACY,SAAS,CAAC;YACzBb,QAAQC,MAAM,CAACa,QAAQ,CAAC;YACxBd,QAAQC,MAAM,CAACc,KAAK,CAACP,cAAcG;QACrC;IACF;IAEA,MAAMK,OAAO;QACX,IAAIjB,cAAc;YAChBC,QAAQC,MAAM,CAACY,SAAS,CAAC;YACzBb,QAAQC,MAAM,CAACa,QAAQ,CAAC;QAC1B;IACF;IAEA,MAAMG,WAAW,IAAMZ;IAEvB,OAAO;QAAEK;QAAQM;QAAMC;IAAS;AAClC,EAAE"}