export const createTaskRunner = (limit)=>{
    let running = 0;
    const waiting = [];
    const scheduleTask = async (task)=>{
        while(running >= limit){
            await new Promise((resolve)=>waiting.push(resolve));
        }
        running++;
        try {
            await task();
        } finally{
            running--;
            waiting.shift()?.();
        }
    };
    const tasks = [];
    const runTask = (task)=>{
        tasks.push(scheduleTask(task));
    };
    const waitForTasks = async ()=>{
        await Promise.all(tasks);
    };
    return {
        runTask,
        waitForTasks
    };
};

//# sourceMappingURL=task-runner.js.map