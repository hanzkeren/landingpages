{"version":3,"sources":["../../../src/lib/utils/task-runner.ts"],"sourcesContent":["export const createTaskRunner = (limit: number) => {\n  let running = 0;\n  const waiting: (() => void)[] = [];\n  const scheduleTask = async (task: () => Promise<void>) => {\n    while (running >= limit) {\n      await new Promise<void>((resolve) => waiting.push(resolve));\n    }\n    running++;\n    try {\n      await task();\n    } finally {\n      running--;\n      waiting.shift()?.();\n    }\n  };\n  const tasks: Promise<void>[] = [];\n  const runTask = (task: () => Promise<void>): void => {\n    tasks.push(scheduleTask(task));\n  };\n  const waitForTasks = async () => {\n    await Promise.all(tasks);\n  };\n  return { runTask, waitForTasks };\n};\n"],"names":["createTaskRunner","limit","running","waiting","scheduleTask","task","Promise","resolve","push","shift","tasks","runTask","waitForTasks","all"],"mappings":"AAAA,OAAO,MAAMA,mBAAmB,CAACC;IAC/B,IAAIC,UAAU;IACd,MAAMC,UAA0B,EAAE;IAClC,MAAMC,eAAe,OAAOC;QAC1B,MAAOH,WAAWD,MAAO;YACvB,MAAM,IAAIK,QAAc,CAACC,UAAYJ,QAAQK,IAAI,CAACD;QACpD;QACAL;QACA,IAAI;YACF,MAAMG;QACR,SAAU;YACRH;YACAC,QAAQM,KAAK;QACf;IACF;IACA,MAAMC,QAAyB,EAAE;IACjC,MAAMC,UAAU,CAACN;QACfK,MAAMF,IAAI,CAACJ,aAAaC;IAC1B;IACA,MAAMO,eAAe;QACnB,MAAMN,QAAQO,GAAG,CAACH;IACpB;IACA,OAAO;QAAEC;QAASC;IAAa;AACjC,EAAE"}