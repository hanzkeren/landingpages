{"version":3,"sources":["../../../src/lib/utils/rsc-path.ts"],"sourcesContent":["// This file should not include Node specific code.\n\nexport const encodeRscPath = (rscPath: string) => {\n  if (rscPath.startsWith('_')) {\n    throw new Error('rscPath must not start with `_`: ' + rscPath);\n  }\n  if (rscPath.endsWith('_')) {\n    throw new Error('rscPath must not end with `_`: ' + rscPath);\n  }\n  if (rscPath === '') {\n    rscPath = '_';\n  }\n  if (rscPath.startsWith('/')) {\n    rscPath = '_' + rscPath;\n  }\n  if (rscPath.endsWith('/')) {\n    rscPath += '_';\n  }\n  return rscPath + '.txt';\n};\n\nexport const decodeRscPath = (rscPath: string) => {\n  if (!rscPath.endsWith('.txt')) {\n    const err = new Error('Invalid encoded rscPath');\n    (err as any).statusCode = 400;\n    throw err;\n  }\n  rscPath = rscPath.slice(0, -'.txt'.length);\n  if (rscPath.startsWith('_')) {\n    rscPath = rscPath.slice(1);\n  }\n  if (rscPath.endsWith('_')) {\n    rscPath = rscPath.slice(0, -1);\n  }\n  return rscPath;\n};\n\nconst FUNC_PREFIX = 'F/';\n\nexport const encodeFuncId = (funcId: string) => {\n  const [file, name] = funcId.split('#') as [string, string];\n  if (name.includes('/')) {\n    throw new Error('Function name must not include `/`: ' + name);\n  }\n  if (file.startsWith('_')) {\n    throw new Error('File must not start with `_`: ' + file);\n  }\n  if (file.startsWith('/')) {\n    return FUNC_PREFIX + '_' + file + '/' + name;\n  }\n  return FUNC_PREFIX + file + '/' + name;\n};\n\nexport const decodeFuncId = (encoded: string) => {\n  if (!encoded.startsWith(FUNC_PREFIX)) {\n    return null;\n  }\n  const index = encoded.lastIndexOf('/');\n  const file = encoded.slice(FUNC_PREFIX.length, index);\n  const name = encoded.slice(index + 1);\n  if (file.startsWith('_')) {\n    return file.slice(1) + '#' + name;\n  }\n  return file + '#' + name;\n};\n"],"names":["encodeRscPath","rscPath","startsWith","Error","endsWith","decodeRscPath","err","statusCode","slice","length","FUNC_PREFIX","encodeFuncId","funcId","file","name","split","includes","decodeFuncId","encoded","index","lastIndexOf"],"mappings":"AAAA,mDAAmD;AAEnD,OAAO,MAAMA,gBAAgB,CAACC;IAC5B,IAAIA,QAAQC,UAAU,CAAC,MAAM;QAC3B,MAAM,IAAIC,MAAM,sCAAsCF;IACxD;IACA,IAAIA,QAAQG,QAAQ,CAAC,MAAM;QACzB,MAAM,IAAID,MAAM,oCAAoCF;IACtD;IACA,IAAIA,YAAY,IAAI;QAClBA,UAAU;IACZ;IACA,IAAIA,QAAQC,UAAU,CAAC,MAAM;QAC3BD,UAAU,MAAMA;IAClB;IACA,IAAIA,QAAQG,QAAQ,CAAC,MAAM;QACzBH,WAAW;IACb;IACA,OAAOA,UAAU;AACnB,EAAE;AAEF,OAAO,MAAMI,gBAAgB,CAACJ;IAC5B,IAAI,CAACA,QAAQG,QAAQ,CAAC,SAAS;QAC7B,MAAME,MAAM,IAAIH,MAAM;QACrBG,IAAYC,UAAU,GAAG;QAC1B,MAAMD;IACR;IACAL,UAAUA,QAAQO,KAAK,CAAC,GAAG,CAAC,OAAOC,MAAM;IACzC,IAAIR,QAAQC,UAAU,CAAC,MAAM;QAC3BD,UAAUA,QAAQO,KAAK,CAAC;IAC1B;IACA,IAAIP,QAAQG,QAAQ,CAAC,MAAM;QACzBH,UAAUA,QAAQO,KAAK,CAAC,GAAG,CAAC;IAC9B;IACA,OAAOP;AACT,EAAE;AAEF,MAAMS,cAAc;AAEpB,OAAO,MAAMC,eAAe,CAACC;IAC3B,MAAM,CAACC,MAAMC,KAAK,GAAGF,OAAOG,KAAK,CAAC;IAClC,IAAID,KAAKE,QAAQ,CAAC,MAAM;QACtB,MAAM,IAAIb,MAAM,yCAAyCW;IAC3D;IACA,IAAID,KAAKX,UAAU,CAAC,MAAM;QACxB,MAAM,IAAIC,MAAM,mCAAmCU;IACrD;IACA,IAAIA,KAAKX,UAAU,CAAC,MAAM;QACxB,OAAOQ,cAAc,MAAMG,OAAO,MAAMC;IAC1C;IACA,OAAOJ,cAAcG,OAAO,MAAMC;AACpC,EAAE;AAEF,OAAO,MAAMG,eAAe,CAACC;IAC3B,IAAI,CAACA,QAAQhB,UAAU,CAACQ,cAAc;QACpC,OAAO;IACT;IACA,MAAMS,QAAQD,QAAQE,WAAW,CAAC;IAClC,MAAMP,OAAOK,QAAQV,KAAK,CAACE,YAAYD,MAAM,EAAEU;IAC/C,MAAML,OAAOI,QAAQV,KAAK,CAACW,QAAQ;IACnC,IAAIN,KAAKX,UAAU,CAAC,MAAM;QACxB,OAAOW,KAAKL,KAAK,CAAC,KAAK,MAAMM;IAC/B;IACA,OAAOD,OAAO,MAAMC;AACtB,EAAE"}