{"version":3,"sources":["../../src/adapters/edge.ts"],"sourcesContent":["import { Hono } from 'hono';\nimport type { MiddlewareHandler } from 'hono';\nimport type { ImportGlobFunction } from 'vite/types/importGlob.d.ts';\nimport {\n  unstable_createServerEntryAdapter as createServerEntryAdapter,\n  unstable_honoMiddleware as honoMiddleware,\n} from 'waku/internals';\n\ndeclare global {\n  interface ImportMeta {\n    glob: ImportGlobFunction;\n  }\n}\n\nconst { contextMiddleware, rscMiddleware, middlewareRunner } = honoMiddleware;\n\nexport default createServerEntryAdapter(\n  (\n    { processRequest, processBuild, notFoundHtml },\n    options?: {\n      middlewareFns?: (() => MiddlewareHandler)[];\n      middlewareModules?: Record<string, () => Promise<unknown>>;\n    },\n  ) => {\n    const { middlewareFns = [], middlewareModules = {} } = options || {};\n    const app = new Hono();\n    app.notFound((c) => {\n      if (notFoundHtml) {\n        return c.html(notFoundHtml, 404);\n      }\n      return c.text('404 Not Found', 404);\n    });\n    app.use(contextMiddleware());\n    for (const middlewareFn of middlewareFns) {\n      app.use(middlewareFn());\n    }\n    app.use(middlewareRunner(middlewareModules as never));\n    app.use(rscMiddleware({ processRequest }));\n    return {\n      fetch: app.fetch,\n      build: processBuild,\n    };\n  },\n);\n"],"names":["Hono","unstable_createServerEntryAdapter","createServerEntryAdapter","unstable_honoMiddleware","honoMiddleware","contextMiddleware","rscMiddleware","middlewareRunner","processRequest","processBuild","notFoundHtml","options","middlewareFns","middlewareModules","app","notFound","c","html","text","use","middlewareFn","fetch","build"],"mappings":"AAAA,SAASA,IAAI,QAAQ,OAAO;AAG5B,SACEC,qCAAqCC,wBAAwB,EAC7DC,2BAA2BC,cAAc,QACpC,iBAAiB;AAQxB,MAAM,EAAEC,iBAAiB,EAAEC,aAAa,EAAEC,gBAAgB,EAAE,GAAGH;AAE/D,eAAeF,yBACb,CACE,EAAEM,cAAc,EAAEC,YAAY,EAAEC,YAAY,EAAE,EAC9CC;IAKA,MAAM,EAAEC,gBAAgB,EAAE,EAAEC,oBAAoB,CAAC,CAAC,EAAE,GAAGF,WAAW,CAAC;IACnE,MAAMG,MAAM,IAAId;IAChBc,IAAIC,QAAQ,CAAC,CAACC;QACZ,IAAIN,cAAc;YAChB,OAAOM,EAAEC,IAAI,CAACP,cAAc;QAC9B;QACA,OAAOM,EAAEE,IAAI,CAAC,iBAAiB;IACjC;IACAJ,IAAIK,GAAG,CAACd;IACR,KAAK,MAAMe,gBAAgBR,cAAe;QACxCE,IAAIK,GAAG,CAACC;IACV;IACAN,IAAIK,GAAG,CAACZ,iBAAiBM;IACzBC,IAAIK,GAAG,CAACb,cAAc;QAAEE;IAAe;IACvC,OAAO;QACLa,OAAOP,IAAIO,KAAK;QAChBC,OAAOb;IACT;AACF,GACA"}