{"version":3,"sources":["../../src/adapters/bun-build-enhancer.ts"],"sourcesContent":["import { writeFileSync } from 'node:fs';\nimport path from 'node:path';\n\nexport type BuildOptions = { distDir: string };\n\nasync function postBuild({ distDir }: BuildOptions) {\n  const SERVE_JS = 'serve-bun.js';\n  const serveCode = `\nimport { unstable_serverEntry } from './server/index.js';\n\nBun.serve({\n  fetch: unstable_serverEntry.fetch,\n});\n`;\n  writeFileSync(path.resolve(distDir, SERVE_JS), serveCode);\n}\n\nexport default async function buildEnhancer(\n  build: (utils: unknown, options: BuildOptions) => Promise<void>,\n): Promise<typeof build> {\n  return async (utils: unknown, options: BuildOptions) => {\n    await build(utils, options);\n    await postBuild(options);\n  };\n}\n"],"names":["writeFileSync","path","postBuild","distDir","SERVE_JS","serveCode","resolve","buildEnhancer","build","utils","options"],"mappings":"AAAA,SAASA,aAAa,QAAQ,UAAU;AACxC,OAAOC,UAAU,YAAY;AAI7B,eAAeC,UAAU,EAAEC,OAAO,EAAgB;IAChD,MAAMC,WAAW;IACjB,MAAMC,YAAY,CAAC;;;;;;AAMrB,CAAC;IACCL,cAAcC,KAAKK,OAAO,CAACH,SAASC,WAAWC;AACjD;AAEA,eAAe,eAAeE,cAC5BC,KAA+D;IAE/D,OAAO,OAAOC,OAAgBC;QAC5B,MAAMF,MAAMC,OAAOC;QACnB,MAAMR,UAAUQ;IAClB;AACF"}